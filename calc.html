 <!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calendário Escala e Folha de Ponto</title>
<style>
body { font-family: Arial, sans-serif; background: #f7f7f7; margin:0; padding:0;}
header { background:#004080; color:white; padding:10px; text-align:center;}
nav { display:flex; justify-content:center; background:#0066cc; flex-wrap: wrap;}
nav button { padding:10px 20px; margin:5px; font-size:16px; cursor:pointer; color:white; background:none; border:none; }
nav button.active { background:#004080; border-radius:5px; }
.container { padding:20px; max-width:800px; margin:auto; }
.month { margin-bottom:30px; background:#fff; padding:10px; border-radius:8px; box-shadow:0 0 5px rgba(0,0,0,0.1);}
.month-name { text-align:center; font-weight:bold; margin-bottom:10px; font-size:18px; }
.calendar { display:grid; grid-template-columns:repeat(7,1fr); gap:5px; text-align:center; }
.day-header { font-weight:bold; padding:5px; }
.day { padding:10px; border-radius:6px; background:#fff; border:1px solid #ddd; min-height:35px; transition: all 0.3s; }
.start { background: lightgreen; transition: background 0.5s ease; }
.work { background: red; color:white; transition: background 0.5s ease; }
.off { background: lightblue; transition: background 0.5s ease; }
.end { background: gray; color:white; transition: background 0.5s ease; }
#info { text-align:center; margin-top:20px; font-size:18px; font-weight:bold; }
input[type=date], input[type=time], input[type=text], button { padding:6px; font-size:16px; margin:5px 0; }
table { width:100%; border-collapse: collapse; margin-top:20px; table-layout: fixed; }
th, td { border:1px solid #ccc; padding:8px; text-align:center; word-wrap: break-word; transition: all 0.3s; }
input[type=time], input[type=text]{ width:90%; box-sizing:border-box; }
tfoot td { text-align:right; }
footer { text-align:center; margin:20px 0; font-size:14px; color:#555; }
.menu-button { position: fixed; top:10px; left:10px; background:#004080; color:white; padding:10px 15px; border:none; border-radius:5px; cursor:pointer; z-index:1000; transition: all 0.3s; }
.menu-button:hover { background:#0066cc; }
.linkedin { position: fixed; bottom:10px; right:10px; display:flex; align-items:center; text-decoration:none; background:#0077B5; color:white; padding:5px 10px; border-radius:5px; font-weight:bold; transition: all 0.3s; }
.linkedin:hover { background:#005582; }
.linkedin img { width:20px; height:20px; margin-right:5px; }
@media(max-width:600px){ 
  .day { font-size:12px; padding:8px; } 
  .day-header { font-size:12px; } 
  button, input{ font-size:14px; } 
  input[type=time], input[type=text]{ width:100%; }
}
</style>
</head>
<body>

<button class="menu-button" onclick="window.location.href='index.html'">Voltar ao Menu</button>


<header><h1>Calendário e Folha de Ponto 14x14</h1></header>

<nav>
  <button id="tabScale" class="active">Calendário de Escala</button>
  <button id="tabPonto">Folha de Ponto</button>
</nav>

<div class="container">
  <!-- Escala -->
  <div id="scaleTab">
    <div class="controls">
      <label>Data de embarque: <input type="date" id="startDate"></label>
      <button id="generateScale">Gerar Escala</button>
    </div>
    <div class="nav-buttons">
      <button id="prevMonth">Anterior</button>
      <button id="nextMonth">Próximo</button>
    </div>
    <div class="calendar-container" id="calendarContainer"></div>
    <div id="info"></div>
  </div>

  <!-- Folha de Ponto -->
  <div id="pontoTab" style="display:none;">
    <h2>Folha de Ponto</h2>
    <label>Unidade Embarcada: <input type="text" id="unidade" placeholder="Nome da unidade"></label>
    <table id="pontoTable">
      <thead>
        <tr>
          <th>Data</th>
          <th>Dia</th>
          <th>Entrada</th>
          <th>Saída</th>
        </tr>
      </thead>
      <tbody></tbody>
      <tfoot>
        <tr>
          <td colspan="4">Total de Horas: <span id="totalHoras">0h 0m</span></td>
        </tr>
        <tr>
          <td colspan="4">
            <label>Assinatura: <input type="text" id="assinatura" placeholder="Nome"></label>
            <button id="sendPonto">Enviar Folha de Ponto</button>
          </td>
        </tr>
      </tfoot>
    </table>
  </div>
</div>

<footer>&#10084 Construído por Elan Teixeira</footer>

<a href="https://linkedin.com/in/elan-teixeira-a94b35235" target="_blank" class="linkedin">
  <img src="https://cdn-icons-png.flaticon.com/512/174/174857.png" alt="LinkedIn"> LinkedIn
</a>

<script>
// ------------------- Tabs -------------------
const tabScale = document.getElementById("tabScale");
const tabPonto = document.getElementById("tabPonto");
const scaleDiv = document.getElementById("scaleTab");
const pontoDiv = document.getElementById("pontoTab");

tabScale.addEventListener("click", ()=>{
  scaleDiv.style.display="block";
  pontoDiv.style.display="none";
  tabScale.classList.add("active");
  tabPonto.classList.remove("active");
});
tabPonto.addEventListener("click", ()=>{
  scaleDiv.style.display="none";
  pontoDiv.style.display="block";
  tabScale.classList.remove("active");
  tabPonto.classList.add("active");
});

// ------------------- Escala -------------------
const container = document.getElementById("calendarContainer");
const startDateInput = document.getElementById("startDate");
const generateBtn = document.getElementById("generateScale");
const infoDiv = document.getElementById("info");
const prevBtn = document.getElementById("prevMonth");
const nextBtn = document.getElementById("nextMonth");
const unidadeInput = document.getElementById("unidade");

let selectedDate = null;
let currentYear, currentMonth;
const daysOfWeek = ["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"];

function generateMonth(year,month){
  const monthDiv = document.createElement("div");
  monthDiv.classList.add("month");
  const monthName = new Date(year,month).toLocaleString("pt-BR",{month:"long", year:"numeric"});
  const title = document.createElement("div");
  title.classList.add("month-name");
  title.textContent = monthName.toUpperCase();
  monthDiv.appendChild(title);

  const calendarDiv = document.createElement("div");
  calendarDiv.classList.add("calendar");
  daysOfWeek.forEach(d=>{
    const header=document.createElement("div");
    header.textContent=d;
    header.classList.add("day-header");
    calendarDiv.appendChild(header);
  });

  const firstDay = new Date(year,month,1);
  const lastDay = new Date(year,month+1,0);
  const startWeekDay = firstDay.getDay();
  for(let i=0;i<startWeekDay;i++) calendarDiv.appendChild(document.createElement("div"));
  for(let day=1;day<=lastDay.getDate();day++){
    const cell=document.createElement("div");
    cell.textContent=day;
    cell.classList.add("day");
    cell.dataset.date = new Date(year,month,day).toISOString().split("T")[0];
    calendarDiv.appendChild(cell);
  }
  monthDiv.appendChild(calendarDiv);
  return monthDiv;
}

function showMonth(year,month){
  container.innerHTML="";
  container.appendChild(generateMonth(year,month));
  if(selectedDate) applyScale();
}

const now = new Date();
currentYear = now.getFullYear();
currentMonth = now.getMonth();
showMonth(currentYear,currentMonth);

prevBtn.addEventListener("click", ()=>{
  currentMonth--;
  if(currentMonth<0){ currentMonth=11; currentYear--;}
  showMonth(currentYear,currentMonth);
});
nextBtn.addEventListener("click", ()=>{
  currentMonth++;
  if(currentMonth>11){ currentMonth=0; currentYear++;}
  showMonth(currentYear,currentMonth);
});

startDateInput.addEventListener("change", ()=>{
  if(!startDateInput.value) return;
  selectedDate = new Date(startDateInput.value + "T00:00:00");
  if(isNaN(selectedDate)) return;
  currentYear = selectedDate.getFullYear();
  currentMonth = selectedDate.getMonth();
  showMonth(currentYear,currentMonth);
  infoDiv.textContent="";
});

window.addEventListener("load", ()=>{
  const unidadeSalva = localStorage.getItem("unidadeEmbarcada");
  if(unidadeSalva) unidadeInput.value = unidadeSalva;
});

function applyScale(){
  if(!selectedDate) return;
  const days = container.querySelectorAll(".day");
  const pontoBody = document.querySelector("#pontoTable tbody");
  pontoBody.innerHTML="";
  days.forEach(cell=>{
    cell.classList.remove("start","work","off","end");
    const cellDate = new Date(cell.dataset.date);
    const diffDays = Math.floor((cellDate - selectedDate)/(1000*60*60*24));
    if(diffDays===0) cell.classList.add("start");
    else if(diffDays>0){
      const cycleDay = diffDays%28;
      if(cycleDay<14) cell.classList.add("work");
      else cell.classList.add("off");
      if(cycleDay===13){ cell.classList.remove("work"); cell.classList.add("end"); }
    }
    if(cell.classList.contains("work") || cell.classList.contains("start") || cell.classList.contains("end")){
      const row = document.createElement("tr");
      row.innerHTML=`<td>${cellDate.toLocaleDateString("pt-BR")}</td>
                      <td>${cellDate.toLocaleDateString("pt-BR",{weekday:'short'})}</td>
                      <td><input type="time"></td>
                      <td><input type="time"></td>`;
      pontoBody.appendChild(row);
    }
  });
  const desembarque = new Date(selectedDate);
  desembarque.setDate(desembarque.getDate()+13);
  infoDiv.textContent=`Embarque: ${selectedDate.toLocaleDateString("pt-BR")} | Desembarque: ${desembarque.toLocaleDateString("pt-BR")}`;
  if(unidadeInput.value.trim()!=="") localStorage.setItem("unidadeEmbarcada", unidadeInput.value.trim());
  calcularHoras();
}

generateBtn.addEventListener("click", ()=>{
  if(!selectedDate) return alert("Selecione a data de embarque primeiro!");
  applyScale();
});

function calcularHoras(){
  const rows = document.querySelectorAll("#pontoTable tbody tr");
  let totalMinutos = 0;
  rows.forEach(r=>{
    const entrada = r.cells[2].querySelector("input").value;
    const saida = r.cells[3].querySelector("input").value;
    if(entrada && saida){
      const [eh,em] = entrada.split(":").map(Number);
      const [sh,sm] = saida.split(":").map(Number);
      const minutos = (sh*60+sm) - (eh*60+em);
      if(minutos>0) totalMinutos += minutos;
    }
  });
  const h = Math.floor(totalMinutos/60);
  const m = totalMinutos % 60;
  document.getElementById("totalHoras").textContent = `${h}h ${m}m`;
}

document.querySelector("#pontoTable tbody").addEventListener("input", calcularHoras);

document.getElementById("sendPonto").addEventListener("click", ()=>{
  const assinatura = document.getElementById("assinatura").value.trim();
  if(!assinatura) return alert("Por favor, assine antes de enviar!");
  const unidade = unidadeInput.value.trim() || '--';
  const rows = document.querySelectorAll("#pontoTable tbody tr");
  if(rows.length===0) return alert("Não há dados na folha de ponto.");
  
  let corpoEmail = `Folha de Ponto - Assinatura: ${assinatura} | Unidade: ${unidade}\n\n`;
  rows.forEach(r=>{
    const cols = r.querySelectorAll("td");
    const entrada = cols[2].querySelector("input").value;
    const saida = cols[3].querySelector("input").value;
    corpoEmail += `${cols[0].textContent} (${cols[1].textContent}) - Entrada: ${entrada || '--'} Saída: ${saida || '--'}\n`;
  });
  const mailtoLink = `mailto:?subject=Folha de Ponto&body=${encodeURIComponent(corpoEmail)}`;
  window.location.href = mailtoLink;
  alert("Folha de ponto pronta para envio via email!");
});
</script>

</body>
</html>
